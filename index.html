<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solo Leveling - Study Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    * { -webkit-tap-highlight-color: transparent; }
    body { font-family: system-ui, -apple-system, sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // √çcones do Lucide como componentes
    const Icon = ({ name, size = 24, className = "" }) => {
      const ref = React.useRef(null);
      useEffect(() => {
        if (ref.current) {
          ref.current.innerHTML = '';
          const icon = lucide.createElement(lucide.icons[name]);
          icon.setAttribute('width', size);
          icon.setAttribute('height', size);
          if (className) {
            className.split(' ').forEach(c => {
              if (c.startsWith('text-')) {
                const color = getComputedStyle(document.documentElement).getPropertyValue('--tw-' + c.replace('text-', '')) || c;
              }
            });
          }
          ref.current.appendChild(icon);
        }
      }, [name, size]);
      return <span ref={ref} className={`inline-flex ${className}`} style={{verticalAlign: 'middle'}} />;
    };

    function SoloLevelingTracker() {
      const [activeTab, setActiveTab] = useState('home');
      const [showStudyForm, setShowStudyForm] = useState(false);
      const [showTaskForm, setShowTaskForm] = useState(false);
      const [showNewStudyForm, setShowNewStudyForm] = useState(false);
      const [expandedSession, setExpandedSession] = useState(null);
      const [selectedSubject, setSelectedSubject] = useState(null);
      const [showPunishment, setShowPunishment] = useState(false);
      const [punishmentCompleted, setPunishmentCompleted] = useState(false);
      const [expandedTask, setExpandedTask] = useState(null);
      const [selectedNewSubject, setSelectedNewSubject] = useState('');
      const [selectedReview, setSelectedReview] = useState(null);

      const EBBINGHAUS_INTERVALS = [1, 7, 15, 30, 45];

      const subjects = [
        'Comunica√ß√£o e Express√£o',
        'Did√°tica',
        'L√≥gica',
        'Metodologia Cient√≠fica',
        'Psicologia',
        'Chefia e Lideran√ßa',
        'Escritura√ß√£o Profissional',
        'Tecnologia da Informa√ß√£o e Comunica√ß√£o',
        'Gest√£o Contempor√¢nea',
        'Gest√£o de Pessoas',
        'Direito Administrativo',
        'Direito Administrativo Disciplinar Militar',
        'Direito Penal',
        'Direito Penal Militar',
        'Doutrina de Pol√≠cia Ostensiva',
      ];

      const [studyData, setStudyData] = useState({
        sessions: [],
        studyItems: [],
        xp: 0,
        missedReviews: 0,
        pushUpDebt: 0,
      });

      const [exerciseData, setExerciseData] = useState({
        history: [],
        currentStreak: 0,
        bestStreak: 0,
        totalDays: 0,
      });

      const [tasks, setTasks] = useState([]);
      const [taskForm, setTaskForm] = useState({
        title: '',
        details: '',
        deadline: '',
        priority: 'medium',
      });

      const [formData, setFormData] = useState({
        topic: '',
        minutes: '',
        confidence: 3,
        notes: '',
      });

      const ranks = [
        { name: 'Rank E', minXp: 0, maxXp: 299, icon: 'E', color: '#6B7280', bgColor: '#F3F4F6', borderColor: '#D1D5DB', title: 'Ca√ßador Iniciante' },
        { name: 'Rank D', minXp: 300, maxXp: 799, icon: 'D', color: '#059669', bgColor: '#D1FAE5', borderColor: '#6EE7B7', title: 'Ca√ßador Promissor' },
        { name: 'Rank C', minXp: 800, maxXp: 1799, icon: 'C', color: '#2563EB', bgColor: '#DBEAFE', borderColor: '#93C5FD', title: 'Ca√ßador Competente' },
        { name: 'Rank B', minXp: 1800, maxXp: 3499, icon: 'B', color: '#7C3AED', bgColor: '#EDE9FE', borderColor: '#C4B5FD', title: 'Ca√ßador de Elite' },
        { name: 'Rank A', minXp: 3500, maxXp: 5999, icon: 'A', color: '#DC2626', bgColor: '#FEE2E2', borderColor: '#FCA5A5', title: 'Ca√ßador Nacional' },
        { name: 'Rank S', minXp: 6000, maxXp: Infinity, icon: 'S', color: '#000000', bgColor: 'linear-gradient(135deg, #FEF3C7, #FDE68A)', borderColor: '#F59E0B', title: 'Shadow Monarch' },
      ];

      useEffect(() => {
        const saved = localStorage.getItem('solo-leveling-ebbinghaus-v3');
        if (saved) {
          const parsed = JSON.parse(saved);
          if (parsed.studyData) setStudyData(parsed.studyData);
          if (parsed.exerciseData) setExerciseData(parsed.exerciseData);
          if (parsed.tasks) setTasks(parsed.tasks);
        }
      }, []);

      useEffect(() => {
        localStorage.setItem('solo-leveling-ebbinghaus-v3', JSON.stringify({ studyData, exerciseData, tasks }));
      }, [studyData, exerciseData, tasks]);

      const getToday = () => new Date().toISOString().split('T')[0];

      const getTodayDate = () => {
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        return today;
      };

      const addDays = (dateStr, days) => {
        const date = new Date(dateStr);
        date.setDate(date.getDate() + days);
        return date.toISOString().split('T')[0];
      };

      const getNextReviewInterval = (stage) => {
        if (stage < EBBINGHAUS_INTERVALS.length) {
          return EBBINGHAUS_INTERVALS[stage];
        }
        return 45;
      };

      const getReviewStageName = (stage) => {
        const names = ['1¬™ Revis√£o (1 dia)', '2¬™ Revis√£o (7 dias)', '3¬™ Revis√£o (15 dias)', '4¬™ Revis√£o (30 dias)', '5¬™ Revis√£o (45 dias)'];
        if (stage < names.length) return names[stage];
        return 'Revis√£o de Manuten√ß√£o';
      };

      const getPendingReviews = () => {
        const today = getToday();
        return studyData.studyItems
          .filter((item) => item.nextReviewDate <= today)
          .sort((a, b) => new Date(a.nextReviewDate) - new Date(b.nextReviewDate));
      };

      const getUpcomingReviews = () => {
        const today = getToday();
        return studyData.studyItems
          .filter((item) => item.nextReviewDate > today)
          .sort((a, b) => new Date(a.nextReviewDate) - new Date(b.nextReviewDate));
      };

      const getCurrentRank = (xp) => {
        return ranks.find((r) => xp >= r.minXp && xp <= r.maxXp) || ranks[0];
      };

      const getNextRank = (xp) => {
        const currentIndex = ranks.findIndex((r) => xp >= r.minXp && xp <= r.maxXp);
        return ranks[currentIndex + 1] || null;
      };

      const currentRank = getCurrentRank(studyData.xp);
      const nextRank = getNextRank(studyData.xp);
      const xpToNext = nextRank ? nextRank.minXp - studyData.xp : 0;
      const progressInRank = nextRank
        ? ((studyData.xp - currentRank.minXp) / (currentRank.maxXp - currentRank.minXp + 1)) * 100
        : 100;

      const addNewStudySession = () => {
        if (!formData.topic.trim() || !formData.minutes || !selectedNewSubject) return;

        const today = getToday();
        const firstReviewDate = addDays(today, EBBINGHAUS_INTERVALS[0]);

        const newItem = {
          id: Date.now(),
          subject: selectedNewSubject,
          topic: formData.topic,
          studyDate: today,
          reviewStage: 0,
          nextReviewDate: firstReviewDate,
          reviews: [],
          initialConfidence: formData.confidence,
          initialMinutes: parseInt(formData.minutes),
          initialNotes: formData.notes,
        };

        const session = {
          id: Date.now(),
          studyItemId: newItem.id,
          subject: selectedNewSubject,
          topic: formData.topic,
          minutes: parseInt(formData.minutes),
          confidence: formData.confidence,
          notes: formData.notes,
          date: new Date().toISOString(),
          type: 'new',
        };

        setStudyData((prev) => ({
          ...prev,
          sessions: [session, ...prev.sessions],
          studyItems: [newItem, ...prev.studyItems],
          xp: prev.xp + 50,
        }));

        setFormData({ topic: '', minutes: '', confidence: 3, notes: '' });
        setSelectedNewSubject('');
        setShowNewStudyForm(false);
      };

      const completeReview = () => {
        if (!formData.minutes || !selectedReview) return;

        const today = getToday();
        const nextStage = selectedReview.reviewStage + 1;
        const nextInterval = getNextReviewInterval(nextStage);
        const nextReviewDate = addDays(today, nextInterval);

        const session = {
          id: Date.now(),
          studyItemId: selectedReview.id,
          subject: selectedReview.subject,
          topic: `Revis√£o: ${selectedReview.topic}`,
          minutes: parseInt(formData.minutes),
          confidence: formData.confidence,
          notes: formData.notes,
          date: new Date().toISOString(),
          type: 'review',
          reviewStage: selectedReview.reviewStage,
        };

        setStudyData((prev) => ({
          ...prev,
          sessions: [session, ...prev.sessions],
          studyItems: prev.studyItems.map((item) =>
            item.id === selectedReview.id
              ? {
                  ...item,
                  reviewStage: nextStage,
                  nextReviewDate: nextReviewDate,
                  reviews: [...item.reviews, { date: today, confidence: formData.confidence, minutes: parseInt(formData.minutes) }],
                }
              : item
          ),
          xp: prev.xp + 40,
        }));

        setFormData({ topic: '', minutes: '', confidence: 3, notes: '' });
        setSelectedReview(null);
        setShowStudyForm(false);
      };

      const skipReview = () => {
        setStudyData((prev) => ({
          ...prev,
          xp: Math.max(0, prev.xp - 25),
          pushUpDebt: prev.pushUpDebt + 20,
          missedReviews: prev.missedReviews + 1,
        }));
        setShowPunishment(true);
      };

      const completePushUps = () => {
        setStudyData((prev) => ({
          ...prev,
          pushUpDebt: 0,
          xp: prev.xp + 10,
        }));
        setPunishmentCompleted(true);
        setTimeout(() => {
          setShowPunishment(false);
          setPunishmentCompleted(false);
        }, 2000);
      };

      const getSubjectStats = (subject) => {
        const sessions = studyData.sessions.filter((s) => s.subject === subject);
        const items = studyData.studyItems.filter((s) => s.subject === subject);
        const totalMinutes = sessions.reduce((acc, s) => acc + s.minutes, 0);
        return { sessions, items, totalHours: (totalMinutes / 60).toFixed(1) };
      };

      const toggleExerciseDay = (date) => {
        const existingIndex = exerciseData.history.findIndex((h) => h.date === date);
        let newHistory;
        let xpChange = 0;

        if (existingIndex >= 0) {
          const wasCompleted = exerciseData.history[existingIndex].completed;
          newHistory = [...exerciseData.history];
          newHistory[existingIndex] = { ...newHistory[existingIndex], completed: !wasCompleted };
          xpChange = wasCompleted ? -40 : 40;
        } else {
          newHistory = [{ date, completed: true }, ...exerciseData.history];
          xpChange = 40;
        }

        newHistory.sort((a, b) => new Date(b.date) - new Date(a.date));

        let streak = 0;
        const today = getToday();
        for (let i = 0; i < 100; i++) {
          const expectedDate = new Date(today);
          expectedDate.setDate(expectedDate.getDate() - i);
          const expectedDateStr = expectedDate.toISOString().split('T')[0];
          const entry = newHistory.find((h) => h.date === expectedDateStr);
          if (entry && entry.completed) {
            streak++;
          } else {
            break;
          }
        }

        const totalCompleted = newHistory.filter((h) => h.completed).length;

        setExerciseData((prev) => ({
          history: newHistory,
          currentStreak: streak,
          bestStreak: Math.max(prev.bestStreak, streak),
          totalDays: totalCompleted,
        }));

        setStudyData((prev) => ({
          ...prev,
          xp: Math.max(0, prev.xp + xpChange),
        }));
      };

      const getLast30Days = () => {
        const days = [];
        const today = new Date();
        for (let i = 29; i >= 0; i--) {
          const date = new Date(today);
          date.setDate(date.getDate() - i);
          const dateStr = date.toISOString().split('T')[0];
          const entry = exerciseData.history.find((h) => h.date === dateStr);
          days.push({
            date: dateStr,
            completed: entry?.completed || false,
            dayOfWeek: date.toLocaleDateString('pt-BR', { weekday: 'short' }).charAt(0).toUpperCase(),
            dayOfMonth: date.getDate(),
          });
        }
        return days;
      };

      const isTodayCompleted = () => {
        const today = getToday();
        const entry = exerciseData.history.find((h) => h.date === today);
        return entry?.completed || false;
      };

      const addTask = () => {
        if (!taskForm.title.trim()) return;
        const newTask = {
          id: Date.now(),
          title: taskForm.title,
          details: taskForm.details,
          deadline: taskForm.deadline,
          priority: taskForm.priority,
          completed: false,
          createdAt: new Date().toISOString(),
        };
        setTasks((prev) => [newTask, ...prev]);
        setTaskForm({ title: '', details: '', deadline: '', priority: 'medium' });
        setShowTaskForm(false);
      };

      const toggleTask = (id) => {
        setTasks((prev) =>
          prev.map((t) => {
            if (t.id === id) {
              const wasCompleted = t.completed;
              if (!wasCompleted) {
                setStudyData((s) => ({ ...s, xp: s.xp + 25 }));
              } else {
                setStudyData((s) => ({ ...s, xp: Math.max(0, s.xp - 25) }));
              }
              return { ...t, completed: !t.completed };
            }
            return t;
          })
        );
      };

      const deleteTask = (id) => {
        setTasks((prev) => prev.filter((t) => t.id !== id));
      };

      const getTaskStatus = (task) => {
        if (task.completed) return 'completed';
        if (!task.deadline) return 'pending';
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        const deadline = new Date(task.deadline);
        if (deadline < today) return 'overdue';
        const diffDays = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));
        if (diffDays <= 2) return 'urgent';
        return 'pending';
      };

      const sortedTasks = [...tasks].sort((a, b) => {
        if (a.completed !== b.completed) return a.completed ? 1 : -1;
        if (a.deadline && b.deadline) return new Date(a.deadline) - new Date(b.deadline);
        if (a.deadline) return -1;
        if (b.deadline) return 1;
        return 0;
      });

      const pendingTasks = tasks.filter((t) => !t.completed).length;
      const pendingReviews = getPendingReviews();
      const upcomingReviews = getUpcomingReviews();
      const studiedSubjects = [...new Set(studyData.studyItems.map((s) => s.subject))];

      const formatDate = (dateStr) => {
        const date = new Date(dateStr + 'T00:00:00');
        return date.toLocaleDateString('pt-BR', { day: '2-digit', month: 'short' });
      };

      const getDaysUntil = (dateStr) => {
        const today = getTodayDate();
        const target = new Date(dateStr + 'T00:00:00');
        const diff = Math.ceil((target - today) / (1000 * 60 * 60 * 24));
        return diff;
      };

      return (
        <div className="min-h-screen bg-gradient-to-b from-slate-50 to-slate-100">
          <div className="max-w-md mx-auto">

            {/* Punishment Modal */}
            {showPunishment && studyData.pushUpDebt > 0 && (
              <div className="fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50">
                <div className="w-full max-w-md bg-white rounded-3xl p-6 shadow-2xl border-4 border-red-500">
                  {!punishmentCompleted ? (
                    <>
                      <div className="text-center mb-6">
                        <div className="w-20 h-20 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center">
                          <Icon name="AlertTriangle" size={40} className="text-red-500" />
                        </div>
                        <h3 className="text-2xl font-black text-red-600 mb-2">‚ö†Ô∏è PUNI√á√ÉO ‚ö†Ô∏è</h3>
                        <p className="text-slate-600">Voc√™ pulou a revis√£o!</p>
                      </div>
                      <div className="bg-red-50 rounded-2xl p-6 mb-6 border-2 border-red-200">
                        <p className="text-center text-slate-700 mb-2">Sua d√≠vida:</p>
                        <div className="text-6xl font-black text-red-600 text-center mb-2">{studyData.pushUpDebt}</div>
                        <p className="text-center text-2xl font-bold text-red-500">FLEX√ïES</p>
                      </div>
                      <div className="space-y-3">
                        <button onClick={completePushUps} className="w-full py-4 rounded-2xl font-bold text-white bg-gradient-to-r from-green-500 to-emerald-600 shadow-lg">
                          ‚úÖ COMPLETEI (+10 XP)
                        </button>
                        <button onClick={() => setShowPunishment(false)} className="w-full py-3 rounded-xl text-slate-500 text-sm">
                          Lembrar depois
                        </button>
                      </div>
                    </>
                  ) : (
                    <div className="text-center py-8">
                      <div className="text-6xl mb-4">üí™</div>
                      <h3 className="text-2xl font-bold text-green-600 mb-2">BEM FEITO!</h3>
                      <p className="text-slate-600">D√≠vida quitada!</p>
                    </div>
                  )}
                </div>
              </div>
            )}

            {/* HOME TAB */}
            {activeTab === 'home' && (
              <div className="p-4 pb-24 space-y-4">
                {/* Rank Card */}
                <div
                  className="rounded-3xl p-6 shadow-xl border-2"
                  style={{
                    background: currentRank.name === 'Rank S' ? currentRank.bgColor : `linear-gradient(135deg, ${currentRank.bgColor}, white)`,
                    borderColor: currentRank.borderColor,
                  }}
                >
                  <div className="flex items-start justify-between mb-4">
                    <div>
                      <div
                        className="w-16 h-16 rounded-2xl flex items-center justify-center text-4xl font-black mb-3 shadow-lg"
                        style={{ backgroundColor: currentRank.color, color: 'white' }}
                      >
                        {currentRank.icon}
                      </div>
                      <h2 className="text-2xl font-black" style={{ color: currentRank.color }}>{currentRank.name}</h2>
                      <p className="text-slate-500 text-sm font-medium">{currentRank.title}</p>
                    </div>
                    <div className="text-right">
                      <div className="flex items-center gap-1 mb-1">
                        <Icon name="Zap" size={20} className="text-amber-500" />
                        <span className="text-2xl font-black text-slate-800">{studyData.xp}</span>
                      </div>
                      <p className="text-xs text-slate-500">PONTOS DE PODER</p>
                    </div>
                  </div>

                  <div className="mb-2">
                    <div className="flex justify-between text-xs text-slate-500 mb-1">
                      <span>{currentRank.name}</span>
                      <span>{nextRank ? nextRank.name : 'MAX'}</span>
                    </div>
                    <div className="w-full bg-slate-200 rounded-full h-4 overflow-hidden">
                      <div className="h-full rounded-full transition-all duration-500" style={{ width: `${progressInRank}%`, backgroundColor: currentRank.color }} />
                    </div>
                    <p className="text-xs text-slate-500 mt-1 text-right">
                      {nextRank ? `${xpToNext} XP para ${nextRank.name}` : 'üèÜ Rank M√°ximo!'}
                    </p>
                  </div>

                  {studyData.pushUpDebt > 0 && (
                    <button onClick={() => setShowPunishment(true)} className="w-full mt-4 py-3 rounded-xl bg-red-100 border-2 border-red-300 flex items-center justify-center gap-2">
                      <Icon name="AlertTriangle" size={20} className="text-red-500" />
                      <span className="font-bold text-red-600">D√çVIDA: {studyData.pushUpDebt} FLEX√ïES</span>
                    </button>
                  )}
                </div>

                {/* New Study Button */}
                <button onClick={() => setShowNewStudyForm(true)} className="w-full rounded-2xl p-4 bg-gradient-to-r from-emerald-500 to-green-600 shadow-lg flex items-center justify-center gap-3">
                  <Icon name="Plus" size={24} className="text-white" />
                  <span className="text-white font-bold text-lg">Novo Estudo (+50 XP)</span>
                </button>

                {/* Pending Reviews */}
                {pendingReviews.length > 0 && (
                  <div className="rounded-3xl p-5 bg-white shadow-lg border-2 border-amber-300">
                    <div className="flex items-center gap-3 mb-4">
                      <div className="w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center">
                        <Icon name="Brain" size={24} className="text-amber-600" />
                      </div>
                      <div>
                        <h3 className="text-lg font-bold text-slate-800">Revis√µes Pendentes</h3>
                        <p className="text-xs text-amber-600 font-medium">Curva de Ebbinghaus</p>
                      </div>
                      <span className="ml-auto bg-amber-500 text-white text-sm font-bold px-3 py-1 rounded-full">{pendingReviews.length}</span>
                    </div>

                    <div className="space-y-3">
                      {pendingReviews.slice(0, 3).map((item) => {
                        const daysLate = Math.abs(getDaysUntil(item.nextReviewDate));
                        const isLate = getDaysUntil(item.nextReviewDate) < 0;

                        return (
                          <div key={item.id} className={`rounded-2xl p-4 border-2 ${isLate ? 'bg-red-50 border-red-200' : 'bg-amber-50 border-amber-200'}`}>
                            <div className="flex items-start justify-between mb-2">
                              <div className="flex-1">
                                <p className="text-xs text-slate-500">{item.subject}</p>
                                <h4 className="font-bold text-slate-800">{item.topic}</h4>
                              </div>
                              {isLate && (
                                <span className="bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full">{daysLate}d atrasada</span>
                              )}
                            </div>

                            <div className="flex items-center gap-2 mb-3">
                              <span className={`text-xs px-2 py-1 rounded-full font-medium ${
                                item.reviewStage === 0 ? 'bg-blue-100 text-blue-700' :
                                item.reviewStage === 1 ? 'bg-purple-100 text-purple-700' :
                                item.reviewStage === 2 ? 'bg-pink-100 text-pink-700' :
                                item.reviewStage === 3 ? 'bg-orange-100 text-orange-700' :
                                'bg-green-100 text-green-700'
                              }`}>
                                {getReviewStageName(item.reviewStage)}
                              </span>
                            </div>

                            <div className="grid grid-cols-2 gap-2">
                              <button onClick={() => { setSelectedReview(item); setShowStudyForm(true); }} className="py-3 rounded-xl font-bold text-white bg-gradient-to-r from-amber-500 to-orange-500 flex items-center justify-center gap-2">
                                <Icon name="CheckCircle2" size={18} className="text-white" />
                                Revisar
                              </button>
                              <button onClick={() => skipReview()} className="py-3 rounded-xl font-bold text-red-600 bg-red-50 border-2 border-red-200">
                                Pular
                              </button>
                            </div>
                          </div>
                        );
                      })}

                      {pendingReviews.length > 3 && (
                        <p className="text-center text-sm text-amber-600 font-medium">+{pendingReviews.length - 3} mais revis√µes pendentes</p>
                      )}
                    </div>
                  </div>
                )}

                {/* No Pending Reviews */}
                {pendingReviews.length === 0 && studyData.studyItems.length > 0 && (
                  <div className="rounded-3xl p-6 bg-white shadow-lg border border-slate-200 text-center">
                    <div className="w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center">
                      <Icon name="CheckCircle2" size={32} className="text-green-500" />
                    </div>
                    <h3 className="text-lg font-bold text-slate-800 mb-2">Tudo em dia! üéâ</h3>
                    <p className="text-sm text-slate-500">
                      Pr√≥xima revis√£o: {upcomingReviews[0] ? formatDate(upcomingReviews[0].nextReviewDate) : 'Nenhuma'}
                    </p>
                  </div>
                )}

                {/* Empty State */}
                {studyData.studyItems.length === 0 && (
                  <div className="rounded-3xl p-6 bg-white shadow-lg border border-slate-200 text-center">
                    <div className="w-16 h-16 mx-auto mb-4 bg-slate-100 rounded-full flex items-center justify-center">
                      <Icon name="BookOpen" size={32} className="text-slate-400" />
                    </div>
                    <h3 className="text-lg font-bold text-slate-800 mb-2">Comece a estudar!</h3>
                    <p className="text-sm text-slate-500 mb-4">Registre seu primeiro estudo para iniciar o sistema de revis√£o.</p>
                  </div>
                )}

                {/* Stats */}
                <div className="grid grid-cols-3 gap-3">
                  <div className="rounded-2xl p-4 bg-white shadow-lg border border-slate-200">
                    <Icon name="Award" size={20} className="text-emerald-500 mb-2" />
                    <p className="text-xs text-slate-500">Estudos</p>
                    <p className="text-2xl font-black text-slate-800">{studyData.studyItems.length}</p>
                  </div>
                  <div className="rounded-2xl p-4 bg-white shadow-lg border border-slate-200">
                    <Icon name="RefreshCw" size={20} className="text-amber-500 mb-2" />
                    <p className="text-xs text-slate-500">Revis√µes</p>
                    <p className="text-2xl font-black text-slate-800">{studyData.sessions.filter((s) => s.type === 'review').length}</p>
                  </div>
                  <div className="rounded-2xl p-4 bg-white shadow-lg border border-slate-200">
                    <Icon name="Dumbbell" size={20} className="text-purple-500 mb-2" />
                    <p className="text-xs text-slate-500">Streak</p>
                    <p className="text-2xl font-black text-slate-800">{exerciseData.currentStreak}üî•</p>
                  </div>
                </div>

                {/* Upcoming Reviews Preview */}
                {upcomingReviews.length > 0 && (
                  <div className="rounded-2xl p-4 bg-white shadow-lg border border-slate-200">
                    <h3 className="text-sm font-bold text-slate-800 mb-3 flex items-center gap-2">
                      <Icon name="Calendar" size={16} className="text-blue-500" />
                      Pr√≥ximas Revis√µes
                    </h3>
                    <div className="space-y-2">
                      {upcomingReviews.slice(0, 3).map((item) => {
                        const days = getDaysUntil(item.nextReviewDate);
                        return (
                          <div key={item.id} className="flex items-center justify-between text-sm">
                            <div className="flex-1 truncate">
                              <span className="text-slate-600">{item.topic}</span>
                              <p className="text-xs text-slate-400">{item.subject}</p>
                            </div>
                            <span className={`text-xs font-medium px-2 py-1 rounded-full ml-2 ${days <= 1 ? 'bg-amber-100 text-amber-700' : 'bg-slate-100 text-slate-600'}`}>
                              {days === 0 ? 'Hoje' : days === 1 ? 'Amanh√£' : `${days}d`}
                            </span>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                )}

                {/* New Study Form Modal */}
                {showNewStudyForm && (
                  <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                    <div className="w-full max-w-md bg-white rounded-3xl p-6 shadow-2xl max-h-[90vh] overflow-y-auto">
                      <div className="flex items-center justify-between mb-6">
                        <h3 className="text-2xl font-black text-slate-800">Novo Estudo</h3>
                        <button onClick={() => { setShowNewStudyForm(false); setSelectedNewSubject(''); }} className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center">
                          <Icon name="X" size={24} className="text-slate-500" />
                        </button>
                      </div>

                      <div className="space-y-4">
                        <div>
                          <label className="text-sm font-medium text-slate-600 mb-2 block">Mat√©ria</label>
                          <select
                            value={selectedNewSubject}
                            onChange={(e) => setSelectedNewSubject(e.target.value)}
                            className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800 focus:border-blue-400 focus:outline-none"
                          >
                            <option value="">Escolha uma mat√©ria...</option>
                            {subjects.map((subject) => (
                              <option key={subject} value={subject}>{subject}</option>
                            ))}
                          </select>
                        </div>

                        {selectedNewSubject && (
                          <>
                            <div className="bg-emerald-50 rounded-2xl p-4 border border-emerald-200">
                              <p className="text-lg font-bold text-emerald-800">{selectedNewSubject}</p>
                              <p className="text-xs text-emerald-600 mt-1">Revis√µes: 1 dia ‚Üí 7 dias ‚Üí 15 dias ‚Üí 30 dias ‚Üí 45 em 45</p>
                            </div>

                            <div>
                              <label className="text-sm font-medium text-slate-600 mb-1 block">T√≥pico estudado *</label>
                              <input
                                type="text"
                                value={formData.topic}
                                onChange={(e) => setFormData({ ...formData, topic: e.target.value })}
                                placeholder="Ex: Crimes contra a pessoa"
                                className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800 focus:border-blue-400 focus:outline-none"
                              />
                            </div>

                            <div>
                              <label className="text-sm font-medium text-slate-600 mb-1 block">Tempo (minutos) *</label>
                              <input
                                type="number"
                                value={formData.minutes}
                                onChange={(e) => setFormData({ ...formData, minutes: e.target.value })}
                                placeholder="60"
                                className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800 focus:border-blue-400 focus:outline-none"
                              />
                            </div>

                            <div>
                              <label className="text-sm font-medium text-slate-600 mb-2 block">N√≠vel de confian√ßa</label>
                              <div className="flex gap-2">
                                {[1, 2, 3, 4, 5].map((l) => (
                                  <button
                                    key={l}
                                    onClick={() => setFormData({ ...formData, confidence: l })}
                                    className={`flex-1 py-3 rounded-xl font-bold transition-all ${
                                      formData.confidence === l
                                        ? 'bg-emerald-600 text-white shadow-lg scale-105'
                                        : 'bg-slate-100 text-slate-500 hover:bg-slate-200'
                                    }`}
                                  >
                                    {l}
                                  </button>
                                ))}
                              </div>
                            </div>

                            <div>
                              <label className="text-sm font-medium text-slate-600 mb-1 block">Notas (opcional)</label>
                              <textarea
                                value={formData.notes}
                                onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
                                placeholder="Pontos importantes..."
                                rows={3}
                                className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800 resize-none focus:border-blue-400 focus:outline-none"
                              />
                            </div>

                            <button
                              onClick={addNewStudySession}
                              disabled={!formData.topic.trim() || !formData.minutes}
                              className="w-full py-4 rounded-2xl font-bold text-white disabled:opacity-50 shadow-lg bg-gradient-to-r from-emerald-500 to-green-600"
                            >
                              <Icon name="Zap" size={20} className="inline mr-2 text-white" />
                              Registrar (+50 XP)
                            </button>
                          </>
                        )}
                      </div>
                    </div>
                  </div>
                )}

                {/* Review Form Modal */}
                {showStudyForm && selectedReview && (
                  <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                    <div className="w-full max-w-md bg-white rounded-3xl p-6 shadow-2xl max-h-[90vh] overflow-y-auto">
                      <div className="flex items-center justify-between mb-6">
                        <h3 className="text-2xl font-black text-slate-800">Revis√£o</h3>
                        <button onClick={() => { setShowStudyForm(false); setSelectedReview(null); }} className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center">
                          <Icon name="X" size={24} className="text-slate-500" />
                        </button>
                      </div>

                      <div className="bg-amber-50 rounded-2xl p-4 mb-6 border border-amber-200">
                        <p className="text-xs text-amber-600 mb-1">{selectedReview.subject}</p>
                        <p className="text-xl font-bold text-amber-800">{selectedReview.topic}</p>
                        <div className="mt-2 flex items-center gap-2">
                          <span className="text-xs bg-amber-200 text-amber-800 px-2 py-1 rounded-full font-medium">
                            {getReviewStageName(selectedReview.reviewStage)}
                          </span>
                        </div>
                      </div>

                      <div className="space-y-4">
                        <div>
                          <label className="text-sm font-medium text-slate-600 mb-1 block">Tempo de revis√£o (minutos) *</label>
                          <input
                            type="number"
                            value={formData.minutes}
                            onChange={(e) => setFormData({ ...formData, minutes: e.target.value })}
                            placeholder="30"
                            className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800 focus:border-blue-400 focus:outline-none"
                          />
                        </div>

                        <div>
                          <label className="text-sm font-medium text-slate-600 mb-2 block">Confian√ßa ap√≥s revis√£o</label>
                          <div className="flex gap-2">
                            {[1, 2, 3, 4, 5].map((l) => (
                              <button
                                key={l}
                                onClick={() => setFormData({ ...formData, confidence: l })}
                                className={`flex-1 py-3 rounded-xl font-bold transition-all ${
                                  formData.confidence === l
                                    ? 'bg-amber-500 text-white shadow-lg scale-105'
                                    : 'bg-slate-100 text-slate-500 hover:bg-slate-200'
                                }`}
                              >
                                {l}
                              </button>
                            ))}
                          </div>
                        </div>

                        <div>
                          <label className="text-sm font-medium text-slate-600 mb-1 block">Notas (opcional)</label>
                          <textarea
                            value={formData.notes}
                            onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
                            placeholder="Pontos a refor√ßar..."
                            rows={3}
                            className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800 resize-none focus:border-blue-400 focus:outline-none"
                          />
                        </div>

                        <button
                          onClick={completeReview}
                          disabled={!formData.minutes}
                          className="w-full py-4 rounded-2xl font-bold text-white disabled:opacity-50 shadow-lg bg-gradient-to-r from-amber-500 to-orange-500"
                        >
                          <Icon name="RefreshCw" size={20} className="inline mr-2 text-white" />
                          Completar Revis√£o (+40 XP)
                        </button>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* MATERIAS TAB */}
            {activeTab === 'materias' && (
              <div className="p-4 pb-24 space-y-4">
                <h1 className="text-3xl font-black text-slate-800 mb-1">Mat√©rias</h1>
                <p className="text-slate-500 mb-4">{studiedSubjects.length} mat√©rias estudadas ‚Ä¢ {studyData.studyItems.length} t√≥picos</p>

                {subjects.map((subject) => {
                  const stats = getSubjectStats(subject);
                  const isExpanded = selectedSubject === subject;
                  const hasStudied = stats.items.length > 0;

                  return (
                    <div key={subject} className={`rounded-2xl bg-white shadow-lg border-2 overflow-hidden ${hasStudied ? 'border-slate-200' : 'border-slate-100 opacity-60'}`}>
                      <button
                        onClick={() => hasStudied && setSelectedSubject(isExpanded ? null : subject)}
                        className={`w-full p-4 flex items-center justify-between ${hasStudied ? 'hover:bg-slate-50' : ''}`}
                        disabled={!hasStudied}
                      >
                        <div className="flex-1 text-left">
                          <h3 className="font-bold text-slate-800">{subject}</h3>
                          <div className="flex gap-3 text-xs text-slate-500 mt-1">
                            {hasStudied ? (
                              <>
                                <span>{stats.items.length} t√≥picos</span>
                                <span>{stats.sessions.length} sess√µes</span>
                                <span>{stats.totalHours}h</span>
                              </>
                            ) : (
                              <span>N√£o estudada ainda</span>
                            )}
                          </div>
                        </div>
                        {hasStudied && (
                          <Icon name="ChevronDown" size={20} className={`text-slate-400 transition-transform ${isExpanded ? 'rotate-180' : ''}`} />
                        )}
                      </button>

                      {isExpanded && stats.items.length > 0 && (
                        <div className="border-t border-slate-100 p-4 space-y-3">
                          {stats.items.map((item) => {
                            const isItemExpanded = expandedSession === item.id;
                            const daysUntil = getDaysUntil(item.nextReviewDate);

                            return (
                              <div
                                key={item.id}
                                className="rounded-xl p-3 bg-slate-50 border border-slate-200 cursor-pointer"
                                onClick={() => setExpandedSession(isItemExpanded ? null : item.id)}
                              >
                                <div className="flex items-start justify-between">
                                  <div className="flex-1">
                                    <h5 className="font-medium text-slate-800">{item.topic}</h5>
                                    <p className="text-xs text-slate-500 mt-1">
                                      Estudado em {formatDate(item.studyDate)} ‚Ä¢ {item.reviews.length} revis√µes
                                    </p>
                                  </div>
                                  <span className={`text-xs px-2 py-1 rounded-full font-medium ${
                                    daysUntil < 0 ? 'bg-red-100 text-red-700' :
                                    daysUntil === 0 ? 'bg-amber-100 text-amber-700' :
                                    'bg-blue-100 text-blue-700'
                                  }`}>
                                    {daysUntil < 0 ? `${Math.abs(daysUntil)}d atrasada` : daysUntil === 0 ? 'Hoje' : `em ${daysUntil}d`}
                                  </span>
                                </div>

                                {isItemExpanded && (
                                  <div className="mt-3 pt-3 border-t border-slate-200 text-xs space-y-2">
                                    <p className="text-slate-600">
                                      <strong>Pr√≥xima:</strong> {getReviewStageName(item.reviewStage)} em {formatDate(item.nextReviewDate)}
                                    </p>
                                    {item.reviews.length > 0 && (
                                      <div>
                                        <strong className="text-slate-600">Hist√≥rico:</strong>
                                        {item.reviews.map((r, i) => (
                                          <p key={i} className="text-slate-500 ml-2">
                                            {formatDate(r.date)} - {r.minutes}min - Confian√ßa: {r.confidence}/5
                                          </p>
                                        ))}
                                      </div>
                                    )}
                                    {item.initialNotes && (
                                      <p className="text-slate-500"><strong>Notas:</strong> {item.initialNotes}</p>
                                    )}
                                  </div>
                                )}
                              </div>
                            );
                          })}
                        </div>
                      )}
                    </div>
                  );
                })}
              </div>
            )}

            {/* EXERCISE TAB */}
            {activeTab === 'exercise' && (
              <div className="p-4 pb-24 space-y-4">
                <h1 className="text-3xl font-black text-slate-800 mb-2">Treino Di√°rio</h1>

                <div className="rounded-3xl p-6 bg-white shadow-xl border-2 border-slate-200">
                  <div className="text-center mb-4">
                    <p className="text-sm text-slate-500 mb-2">Hoje</p>
                    <button
                      onClick={() => toggleExerciseDay(getToday())}
                      className={`w-24 h-24 rounded-full flex items-center justify-center transition-all shadow-lg ${
                        isTodayCompleted()
                          ? 'bg-gradient-to-br from-green-400 to-emerald-600'
                          : 'bg-slate-100 border-4 border-dashed border-slate-300'
                      }`}
                    >
                      {isTodayCompleted() ? (
                        <Icon name="CheckCircle2" size={48} className="text-white" />
                      ) : (
                        <Icon name="Plus" size={48} className="text-slate-400" />
                      )}
                    </button>
                    <p className="mt-3 text-lg font-bold text-slate-800">
                      {isTodayCompleted() ? '‚úÖ Completo!' : 'Marcar treino'}
                    </p>
                  </div>
                </div>

                <div className="grid grid-cols-3 gap-3">
                  <div className="rounded-2xl p-4 bg-white shadow-lg border border-slate-200 text-center">
                    <p className="text-3xl font-black text-orange-500">{exerciseData.currentStreak}</p>
                    <p className="text-xs text-slate-500">Streak üî•</p>
                  </div>
                  <div className="rounded-2xl p-4 bg-white shadow-lg border border-slate-200 text-center">
                    <p className="text-3xl font-black text-purple-500">{exerciseData.bestStreak}</p>
                    <p className="text-xs text-slate-500">Recorde</p>
                  </div>
                  <div className="rounded-2xl p-4 bg-white shadow-lg border border-slate-200 text-center">
                    <p className="text-3xl font-black text-blue-500">{exerciseData.totalDays}</p>
                    <p className="text-xs text-slate-500">Total</p>
                  </div>
                </div>

                <div className="rounded-2xl p-5 bg-white shadow-lg border border-slate-200">
                  <h3 className="text-lg font-bold text-slate-800 mb-4">√öltimos 30 dias</h3>
                  <div className="grid grid-cols-7 gap-2">
                    {getLast30Days().map((day) => (
                      <button
                        key={day.date}
                        onClick={() => toggleExerciseDay(day.date)}
                        className={`aspect-square rounded-lg flex flex-col items-center justify-center text-xs font-medium transition-all ${
                          day.completed
                            ? 'bg-green-500 text-white shadow-md'
                            : 'bg-slate-100 text-slate-400 hover:bg-slate-200'
                        } ${day.date === getToday() ? 'ring-2 ring-blue-500 ring-offset-2' : ''}`}
                      >
                        <span className="text-[10px] opacity-70">{day.dayOfWeek}</span>
                        <span>{day.dayOfMonth}</span>
                      </button>
                    ))}
                  </div>
                </div>
              </div>
            )}

            {/* TASKS TAB */}
            {activeTab === 'tasks' && (
              <div className="p-4 pb-24 space-y-4">
                <div className="flex items-center justify-between mb-2">
                  <div>
                    <h1 className="text-3xl font-black text-slate-800">Tarefas</h1>
                    <p className="text-slate-500">{pendingTasks} pendentes</p>
                  </div>
                  <button
                    onClick={() => setShowTaskForm(true)}
                    className="w-12 h-12 rounded-full bg-blue-600 text-white flex items-center justify-center shadow-lg"
                  >
                    <Icon name="Plus" size={24} className="text-white" />
                  </button>
                </div>

                {sortedTasks.length === 0 ? (
                  <div className="rounded-2xl p-8 bg-white shadow-lg border border-slate-200 text-center">
                    <Icon name="ListTodo" size={48} className="mx-auto text-slate-300 mb-4" />
                    <p className="text-slate-500">Nenhuma tarefa</p>
                  </div>
                ) : (
                  <div className="space-y-3">
                    {sortedTasks.map((task) => {
                      const status = getTaskStatus(task);
                      const isExpanded = expandedTask === task.id;

                      return (
                        <div
                          key={task.id}
                          className={`rounded-2xl p-4 bg-white shadow-lg border-2 ${
                            task.completed ? 'border-slate-200 opacity-60' :
                            status === 'overdue' ? 'border-red-300 bg-red-50' :
                            status === 'urgent' ? 'border-amber-300 bg-amber-50' : 'border-slate-200'
                          }`}
                        >
                          <div className="flex items-start gap-3">
                            <button
                              onClick={() => toggleTask(task.id)}
                              className={`mt-1 w-6 h-6 rounded-full border-2 flex items-center justify-center ${
                                task.completed ? 'bg-green-500 border-green-500 text-white' : 'border-slate-300'
                              }`}
                            >
                              {task.completed && <Icon name="CheckCircle2" size={16} className="text-white" />}
                            </button>

                            <div className="flex-1" onClick={() => setExpandedTask(isExpanded ? null : task.id)}>
                              <h4 className={`font-bold ${task.completed ? 'line-through text-slate-400' : 'text-slate-800'}`}>
                                {task.title}
                              </h4>
                              {task.deadline && (
                                <p className={`text-xs mt-1 flex items-center gap-1 ${
                                  status === 'overdue' ? 'text-red-600' : status === 'urgent' ? 'text-amber-600' : 'text-slate-500'
                                }`}>
                                  <Icon name="Clock" size={12} />
                                  {formatDate(task.deadline)}
                                </p>
                              )}
                              {isExpanded && task.details && (
                                <p className="mt-3 pt-3 border-t border-slate-200 text-sm text-slate-600">{task.details}</p>
                              )}
                            </div>

                            <button onClick={() => deleteTask(task.id)} className="text-slate-400 hover:text-red-500">
                              <Icon name="Trash2" size={18} />
                            </button>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}

                {showTaskForm && (
                  <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                    <div className="w-full max-w-md bg-white rounded-3xl p-6 shadow-2xl">
                      <div className="flex items-center justify-between mb-6">
                        <h3 className="text-2xl font-black text-slate-800">Nova Tarefa</h3>
                        <button onClick={() => setShowTaskForm(false)} className="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center">
                          <Icon name="X" size={24} className="text-slate-500" />
                        </button>
                      </div>

                      <div className="space-y-4">
                        <input
                          type="text"
                          value={taskForm.title}
                          onChange={(e) => setTaskForm({ ...taskForm, title: e.target.value })}
                          placeholder="T√≠tulo *"
                          className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800"
                        />
                        <input
                          type="date"
                          value={taskForm.deadline}
                          onChange={(e) => setTaskForm({ ...taskForm, deadline: e.target.value })}
                          className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800"
                        />
                        <textarea
                          value={taskForm.details}
                          onChange={(e) => setTaskForm({ ...taskForm, details: e.target.value })}
                          placeholder="Detalhes"
                          rows={3}
                          className="w-full bg-slate-50 border-2 border-slate-200 rounded-xl px-4 py-3 text-slate-800 resize-none"
                        />
                        <button
                          onClick={addTask}
                          disabled={!taskForm.title.trim()}
                          className="w-full py-4 rounded-2xl font-bold text-white disabled:opacity-50 bg-blue-600"
                        >
                          Criar Tarefa
                        </button>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* PROFILE TAB */}
            {activeTab === 'profile' && (
              <div className="p-4 pb-24 space-y-4">
                <div
                  className="rounded-3xl p-6 shadow-xl border-2"
                  style={{
                    background: currentRank.name === 'Rank S' ? currentRank.bgColor : `linear-gradient(135deg, ${currentRank.bgColor}, white)`,
                    borderColor: currentRank.borderColor,
                  }}
                >
                  <div className="flex items-center gap-4 mb-6">
                    <div
                      className="w-20 h-20 rounded-2xl flex items-center justify-center text-4xl font-black shadow-xl"
                      style={{ backgroundColor: currentRank.color, color: 'white' }}
                    >
                      {currentRank.icon}
                    </div>
                    <div>
                      <h2 className="text-2xl font-black" style={{ color: currentRank.color }}>{currentRank.name}</h2>
                      <p className="text-slate-500 font-medium">{currentRank.title}</p>
                      <p className="font-bold text-slate-700">{studyData.xp} XP</p>
                    </div>
                  </div>

                  <div className="grid grid-cols-2 gap-3">
                    <div className="bg-white/80 rounded-xl p-4 border border-slate-200">
                      <p className="text-sm text-slate-500">T√≥picos</p>
                      <p className="text-3xl font-black text-slate-800">{studyData.studyItems.length}</p>
                    </div>
                    <div className="bg-white/80 rounded-xl p-4 border border-slate-200">
                      <p className="text-sm text-slate-500">Revis√µes</p>
                      <p className="text-3xl font-black text-amber-600">{studyData.sessions.filter((s) => s.type === 'review').length}</p>
                    </div>
                  </div>
                </div>

                <div className="rounded-2xl p-5 bg-white shadow-lg border border-slate-200">
                  <h3 className="text-lg font-bold text-slate-800 mb-4">Curva de Ebbinghaus</h3>
                  <div className="space-y-2 text-sm">
                    {EBBINGHAUS_INTERVALS.map((days, i) => (
                      <div key={i} className="flex justify-between p-2 bg-slate-50 rounded-lg">
                        <span className="text-slate-700">{i + 1}¬™ Revis√£o</span>
                        <span className="font-bold text-blue-600">{days} {days === 1 ? 'dia' : 'dias'}</span>
                      </div>
                    ))}
                    <div className="flex justify-between p-2 bg-green-50 rounded-lg">
                      <span className="text-slate-700">Manuten√ß√£o</span>
                      <span className="font-bold text-green-600">45 em 45 dias</span>
                    </div>
                  </div>
                </div>

                <div className="rounded-2xl p-5 bg-white shadow-lg border border-slate-200">
                  <h3 className="text-lg font-bold text-slate-800 mb-4">Sistema de Ranks</h3>
                  <div className="space-y-2">
                    {ranks.map((r) => {
                      const isUnlocked = studyData.xp >= r.minXp;
                      const isCurrent = currentRank.name === r.name;

                      return (
                        <div
                          key={r.name}
                          className={`flex items-center justify-between p-3 rounded-xl ${
                            isCurrent ? 'ring-2 ring-offset-1' : isUnlocked ? 'bg-slate-50' : 'opacity-40'
                          }`}
                          style={{ ringColor: isCurrent ? r.color : undefined }}
                        >
                          <div className="flex items-center gap-3">
                            <div
                              className="w-10 h-10 rounded-lg flex items-center justify-center text-lg font-black"
                              style={{ backgroundColor: isUnlocked ? r.color : '#CBD5E1', color: 'white' }}
                            >
                              {r.icon}
                            </div>
                            <div>
                              <p className="font-bold text-slate-800 text-sm">{r.name}</p>
                              <p className="text-xs text-slate-500">{r.minXp} XP</p>
                            </div>
                          </div>
                          {isUnlocked && <span className="text-green-500">‚úì</span>}
                        </div>
                      );
                    })}
                  </div>
                </div>

                <button
                  onClick={() => {
                    if (window.confirm('Resetar todos os dados?')) {
                      setStudyData({ sessions: [], studyItems: [], xp: 0, missedReviews: 0, pushUpDebt: 0 });
                      setExerciseData({ history: [], currentStreak: 0, bestStreak: 0, totalDays: 0 });
                      setTasks([]);
                    }
                  }}
                  className="w-full py-4 rounded-2xl font-bold text-red-600 bg-red-50 border-2 border-red-200"
                >
                  Resetar Dados
                </button>
              </div>
            )}
          </div>

          {/* Navigation */}
          <nav className="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 shadow-lg">
            <div className="max-w-md mx-auto flex justify-around py-2 px-2">
              {[
                { id: 'home', icon: 'Home', label: 'Miss√£o' },
                { id: 'materias', icon: 'BookOpen', label: 'Mat√©rias' },
                { id: 'exercise', icon: 'Dumbbell', label: 'Treino' },
                { id: 'tasks', icon: 'ListTodo', label: 'Tarefas' },
                { id: 'profile', icon: 'User', label: 'Perfil' },
              ].map(({ id, icon, label }) => (
                <button
                  key={id}
                  onClick={() => setActiveTab(id)}
                  className={`flex flex-col items-center gap-1 py-2 px-3 rounded-xl transition-all ${
                    activeTab === id ? 'text-blue-600 bg-blue-50' : 'text-slate-400'
                  }`}
                >
                  <Icon name={icon} size={22} />
                  <span className="text-[10px] font-medium">{label}</span>
                </button>
              ))}
            </div>
          </nav>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<SoloLevelingTracker />);
  </script>
</body>
</html>
